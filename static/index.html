<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Library demo</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" integrity="sha512-z3gLpd7yknf1YoNbCzqRKc4qyor8gaKU1qmn+CShxbuBusANI9QpRohGBreCFkKxLhei6S9CQXFEbbKuqLg0DA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/js/all.min.js" integrity="sha512-uKQ39gEGiyUJl4AI6L+ekBdGKpGw4xJ55+xyJG7YFlJokPNYegn9KwQ3P8A7aFQAUtUsAQHep+d/lrGqrbPIDQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>    

    <style>
        body {
            background-color: #f8f9fa;
        }
        .container {
            max-width: 800px;
            margin: auto;
        }
        .row {
            margin-top: 20px;
        }
    </style>
  </head>
  <body>

    <! -- -->

  <div class="container">
    <h1>Prompt Designer!
      <i id="loading-icon" class="fas fa-spinner fa-spin" style="display: none;"></i>
    </h1>

    <! -- Navbar-->

  <!--    <nav class="navbar bg-body-tertiary">
  <div class="container-fluid">
    <form class="d-flex" role="search">
      <input class="form-control me-2" type="search" placeholder="Search" aria-label="Search">
      <button class="btn btn-outline-success" type="submit">Prompting</button>
    </form>
  </div> 
</nav> -->

<!-- -->

<div class="row">
  I am an AI assistant I will help you to learn how to prompting. Please Write a topic of your interest, after we can analyse the answered obtained, then we can find a way to improve the prompting. 
  Let's try it! 
  <div class="col">
    <input id="input-field" type="text" class="form-control" placeholder="What are you intersting in?" aria-label="First name">
  </div>
  <div class="col">
   <!-- <input type="text" class="form-control" placeholder="Last name" aria-label="Last name"> -->
    <button id="submit-button" class="btn btn-outline-success" type="submit">Prompting</button>
  </div>
</div>

<! -- -->
<div class="row"></div>
    <div class="card mb-3" style="max-width: 1808px;">
      <div class="row g-0">
      <div class="col-md-4">
        <img src="/static/img/TeamComputing.png" class="img-fluid rounded-start" alt="...">
      </div>
      <div class="col-md-8">
        <div class="card-body">
          <div class="form-floating">
                <h4>Original Prompt</h4>
                <textarea id="previous-prompt" class="form-control" style="min-height: 150px;"  readonly></textarea>
          <h5 class="card-title">With your prompt you obtaing:</h5>
         <div class="form-floating">
            <textarea class="form-control" placeholder="An AI will answered here. Please wait" id="previous-response" style="min-height: 480px;"></textarea>
             <label for="floatingTextarea">An AI will answered here. Please wait</label> 
          </div>
        </div>

	           <div class= "row"></div>
    <div class="card mb-3" style="max-with: 1808px;">
      <div class="row g-0">
      <div class="col-md-4">
        <img src="/static/img/TeamComputing.png" class="img-fluid rounded-start" alt="...">
      </div>
      <div class ="col-md-8">
        <div class="card-body">
          <div class="form-floating">
            <h4>References</h4>
            <textarea id="refer" class="form-control" style="min-height: 480px;" readonly></textarea>
          </div>
        </div> 




      </div>
      </div>
    </div>
    <!-- main-->



    
   <!-- <div class="container"> 
      <div class="row"> -->
        <div class="card mb-3">
            <h3 class = "text-center p-3 mb-3 mt-3">Do you want to modify your prompt? 
              <i id="loading-icon2" class="fas fa-spinner fa-spin" style="display: none;"></i>
            </h3>
         
            <div class="row">
                <div class="col">
                  <input id="input-field1" type="text" class="form-control" placeholder="What was missing?" aria-label="First name">
                </div>
                <div class="col">
                 <!-- <input type="text" class="form-control" placeholder="Last name" aria-label="Last name"> -->
                  <button id="submit-button2" class="btn btn-outline-success" type="submit">Submit Feedback</button>
                </div>
              </div>
 
        </div>



      
<!--       <div class="row"></div>
      <div class="card mb-3" style="max-width: 1808px;">
        <div class="row g-0">
          <div class="col-md-4">
            <img src="studing2.png" class="img-fluid rounded-start" alt="...">
          </div>
          <div class="col-md-8">
            <div class="card-body">
              <h5 class="card-title">AI suggest</h5>
             <div class="form-floating">
                <textarea class="form-control" placeholder="Leave a comment here" id="floatingTextarea"></textarea>
                <label for="floatingTextarea">An AI will give you some suggestions here.</label>
              </div>
              <p class="card-text"><small class="text-body-secondary">Last updated few mins ago</small></p>
            </div>
          </div>
        </div>
      </div>-->
 <!--   </div>  

 Carousel-->

<div id="carouselExample" class="carousel carousel-dark slide">
  <div  id="carouselItems" class="carousel-inner">
    <div class="carousel-item active">
      <div class="card mb-3" style="max-width: 1808px;">
        <div class="row g-0">
          <div class="col-md-2">
            <img src="/static/img/w1.png" class="img-fluid rounded-start" alt="...">
          </div>
          <div class="col-md-8">
            <div class="card-body">
              <h5 class="card-title">History of your learning </h5>
              <p class="card-text"><small class="text-body-secondary">All suggestions will be here. Use the bottons</small></p>
              <p class="card-text"><small class="text-body-secondary">Last updated few mins ago</small></p>
            </div>
          </div>

        </div>
      </div>
    </div>
    <div class="carousel-item">         <!--second card carrousel-->
       <div class="card mb-3" style="max-width: 1808px;">
        <div class="row g-0">
          <div class="col-md-2">
            <img src="/static/img/w2.png" class="img-fluid rounded-start" alt="...">
          </div>
          <div class="col-md-2">
            <div class="card-body">
              <h5 class="card-title">Lesson for your. </h5>
              <p class="card-text"><small class="text-body-secondary">A lesson will be here. Use the bottons</small></p>
              <p class="card-text"><small class="text-body-secondary">Last updated few mins ago</small></p>
            </div>
          </div>
          <div class="col-md-2">
            <img src="/static/img/w2.png" class="img-fluid rounded-start" alt="...">
          </div>
          <div class="col-md-2">
            <div class="card-body">
              <h5 class="card-title">A Prompt recommended. </h5>
              <p id="previous-response" class="card-text"><small class="text-body-secondary">All suggestions will be here. Use the bottons</small></p>
              <p class="card-text"><small class="text-body-secondary">Last updated few mins ago</small></p>
            </div>
          </div>
          <div class="col-md-2">
            <img src="/static/img/w2.png" class="img-fluid rounded-start" alt="...">
          </div>
          <div class="col-md-2">
            <div class="card-body">
              <h5 class="card-title">The result of modifications </h5>
              <p class="card-text"><small class="text-body-secondary">You will see the new results here.</small></p>
              <p class="card-text"><small class="text-body-secondary">Last updated few mins ago</small></p>
            </div>
          </div>
        </div>
      </div>
    </div>

  </div>
  <button class="carousel-control-prev" type="button" data-bs-target="#carouselExample" data-bs-slide="prev">
    <span class="carousel-control-prev-icon" aria-hidden="true"></span>
    <span class="visually-hidden">Previous</span>
  </button>
  <button class="carousel-control-next" type="button" data-bs-target="#carouselExample" data-bs-slide="next">
    <span class="carousel-control-next-icon" aria-hidden="true"></span> 
   <!-- <span class="btn-bd-primary" aria-hidden="true"></span>-->
    <span class="visually-hidden">Next</span>
  </button> 
</div>
</div>
<!-- end Carousel-->

<div class= "row"></div>
    <div class="card mb-3" style="max-with: 1808px;">
      <div class="row g-0">
      <div class="col-md-4">
        <img src="/static/img/TeamComputing.png" class="img-fluid rounded-start" alt="...">
      </div>
      <div class ="col-md-8">
        <div class="card-body">
          <div class="form-floating">
            <h4>References</h4>
            <textarea id="refer" class="form-control" style="min-height: 480px;" readonly></textarea>
          </div>
        </div>
     <!-- </div>-->
      
 <div class= "row"></div>   
<div id="containerAdd1">
</div>
<button id="newQ" onclick="reload()">New question</button>
<!-- <button id="submit-button3" onclick="addItem2()">Click me</button> -->


<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.2/js/bootstrap.min.js" integrity="sha512-WW8/jxkELe2CAiE4LvQfwm1rajOS8PHasCCx+knHG0gBHt8EXxS6T6tJRTGuDQVnluuAvMxWF4j8SNFDKceLFg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
</script>
<script
  src="https://code.jquery.com/jquery-3.7.1.js"
  integrity="sha256-eKhayi8LEQwp4NKxN+CfCh+3qOVUtJn3QNZ0TciWLP4="
  crossorigin="anonymous"></script>

<script> 

function addItem2(){

    $('.carousel-item').removeClass('active');
    const newcard = document.createElement('DIV');
    newcard.innerHTML = `
      <div class="card mb-3" style="max-width: 1808px;">
        <div class="row g-0">
          
          <div class="col-md-4">
            <div class="card-body">
              <h5 class="card-title">Lesson </h5>
              <div class="form-floating">
            <p class="card-text"><small class="text-body-secondary">`+ states.lessson + `</small></p>
          </div>
              
              <p class="card-text"><small class="text-body-secondary">Last updated few mins ago</small></p>
            </div>
          </div>
          
          <div class="col-md-4">
            <div class="card-body">
              <h6 class="card-title">Prompt recommended </h6>
              <p class="card-text"><small class="text-body-secondary"> ` + states.lastPrompt + `</small></p>
	      <br>
	      <h6 class="card-title">References </h6>
	      <p id="refer1" class="card-text"><small class="text-body-secondary"> ` +states.lastReference + ` </small></p>

       	
            </div>
          </div>

          <div class="col-md-4">
            <div class="card-body">
              <h5 class="card-title"> Result </h5>
              <p class="card-text"><small class="text-body-secondary"> ` +states.lastResponse + ` </small></p>
              <p class="card-text"><small class="text-body-secondary">Last updated few mins ago</small></p>
            </div>
          </div>
        </div>
      </div>
    `;
    newcard.className = "carousel-item active";
    document.getElementById('carouselItems').appendChild(newcard);

    // const new_refer =document.createElement('DIV');
    // new_refer.innerHTML= `
	   //  <p class="card-text"><small class="text-body-secondary"> ` +states.lastReference + ` </small></p>
    // `;    
    // document.getElementById('refer').appendChild(new_refer);
    } 

    function addItem(){
      var titlear= ["Lesson", "New Prompt", "Answer"];
      var lessontext = [];
      var NewPrompt = [];
      var NewAnswer = [];



    const card = document.querySelector('.carouselExample')
    const newcardbox = document.createElement('DIV');
    newcardbox.className = 'carousel-inner row';
    const newcardbody1 = document.createElement('DIV');
    newcardbody1.className = 'carousel-item active';
    const newcardbody2 = document.createElement('DIV');
    newcardbody2.className = 'card mb-3 col';
    const newcardbody3 = document.createElement('DIV');
    newcardbody3.className = 'col-md-4 col';
    const newimage = document.createElement('IMG');
    newimage.className = 'img-fluid rounded-start';
    newimage.scr = 'booksColors.png';
    const newcardbody4 = document.createElement('DIV');
    newcardbody4.className = 'col-md-8 col';
    const newcardbody = document.createElement('DIV');
    newcardbody.className = 'card-body';
    const newh5 = document.createElement('H5');
    newh5.className = 'card-title';
    const newdivtestarea = document.createElement('DIV');
    newdivtestarea.className = 'form-floating';
    var texxarea = document.createElement('TEXTAREA');
    texxarea.className = 'form-control';
    var newlabel = document.createElement('LABEL');
    const newp = document.createElement('P');
    newp.className = 'card-text'
    newp.innerText = 'Lesson'
    var newlabel1 = document.createElement('LABEL');
    const newp1 = document.createElement('P');
    newp1.className = 'card-text1'
    newp1.innerText = 'Rcommended Prompt '

    const newp2 = document.createElement('P');
    newp2.className = 'card-text2'
    newp2.innerText = 'Result'


    newcardbox.appendChild(newcardbody1)
    newcardbody1.appendChild(newcardbody2)
    newcardbody2.appendChild(newp)
    newcardbody1.appendChild(newcardbody3)
    newcardbody3.appendChild(newp1)
    newcardbody1.appendChild(newcardbody4)
    newcardbody4.appendChild(newp2)
    //newcardbody4.appendChild(newp1)


    document.getElementById('carouselExample').appendChild(newcardbox);
    } 


     
</script>


      <script>
        var session_id = '';
    
        async function submitForm(input_val, stream=false) {
            $("#output").html('Processing...'); 
            $("#loading-icon").show(); 
            $("#loading-icon2").show(); 
            var outputDiv = document.getElementById('output');
            var submitParams = {
                'session_id': session_id,
                'input_val': input_val
            }
            if (typeof stream !== "undefined" && stream) {
              let params = (new URLSearchParams(submitParams)).toString();
              let url = '/?stream=true';
              // let url = '/?';
              if (params) {
                url += '&' + params;
                // url += params;
              }
              const eventSource = new EventSource(url);
      
              eventSource.onmessage = function(event) {
                  console.log(event.data);
                  outputDiv.textContent += event.data;
              };
      
              eventSource.addEventListener('end_paragraph', function(event) {
                  console.log(event);
                  let data = JSON.parse(event.data);
                  data.interState = 'intermediate';
                  handleData(data);
              });
      
              eventSource.addEventListener('finished', function(event) {
                  console.log(event);
                  let data = JSON.parse(event.data);
                  data.interState = 'finished';
                  handleData(data);
                  eventSource.close();
                  $("#loading-icon").hide();
                  $("#loading-icon2").hide();
              });
            }
            else {
              const response = await fetch('/', {
                  method: 'POST',
                  headers: {
                      'Content-Type': 'application/x-www-form-urlencoded'
                  },
                  body: new URLSearchParams(submitParams)
              });
      
              if (response.ok) {
                  const data = await response.json();
                  handleData(data);
                  $("#loading-icon").hide();
                  $("#loading-icon2").hide();
              } else {
                  outputDiv.innerHTML = '<p>An error occurred while submitting the form.</p>';
                  $("#loading-icon").hide();
                  $("#loading-icon2").hide();
              } 
            }
        }
    
        function handleData(data) {
          if (data.hasOwnProperty('interState')) {
            if (data.interState == 'intermediate' || data.interState == 'finished') {
              processData(data);
            }
          } else {
            processData(data);
          }
        }
    
        function processData(data) {


          if (data.hasOwnProperty('session_id')) {
                session_id = data.session_id;
                if (data.hasOwnProperty('sections')) {
                    if (data.sections.hasOwnProperty('GENERATE_RESPONSE')) {
                        $("#previous-response").val(data.sections.GENERATE_RESPONSE);
                    }
                    if (data.sections.hasOwnProperty('GIVE_LESSON')) {
                        states.lessson = data.sections.GIVE_LESSON;
                    }
                    if (data.sections.hasOwnProperty('GENERATE_UPDATED_PROMPT')) {
                        states.lastPrompt = data.sections.GENERATE_UPDATED_PROMPT;
                    }
                    if (data.sections.hasOwnProperty('GIVE_NEW_RESPONSE')) {
                        states.lastResponse = data.sections.GIVE_NEW_RESPONSE;
                    }
                }
            }
            addItem2()
        }

        async function submitForm1(input_val, stream=false) {
            $("#output").html('Processing...'); 
            $("#loading-icon").show(); 
            $("#loading-icon2").show(); 
            var outputDiv = document.getElementById('output');
            var submitParams = {
                'session_id': session_id,
                'input_val': input_val
            }
            if (typeof stream !== "undefined" && stream) {
              let params = (new URLSearchParams(submitParams)).toString();
              let url = '/?stream=true';
              // let url = '/?';
              if (params) {
                url += '&' + params;
                // url += params;
              }
              const eventSource = new EventSource(url);
      
              eventSource.onmessage = function(event) {
                  console.log(event.data);
                  outputDiv.textContent += event.data;
              };
      
              eventSource.addEventListener('end_paragraph', function(event) {
                  console.log(event);
                  let data = JSON.parse(event.data);
                  data.interState = 'intermediate';
                  handleData1(data);
              });
      
              eventSource.addEventListener('finished', function(event) {
                  console.log(event);
                  let data = JSON.parse(event.data);
                  data.interState = 'finished';
                  handleData1(data);
                  eventSource.close();
                  $("#loading-icon").hide();
                  $("#loading-icon2").hide();
              });
            }
            else {
              const response = await fetch('/', {
                  method: 'POST',
                  headers: {
                      'Content-Type': 'application/x-www-form-urlencoded'
                  },
                  body: new URLSearchParams(submitParams)
              });
      
              if (response.ok) {
                  const data = await response.json();
                  handleData1(data);
                  $("#loading-icon").hide();
                  $("#loading-icon2").hide();
              } else {
                  outputDiv.innerHTML = '<p>An error occurred while submitting the form.</p>';
                  $("#loading-icon").hide();
                  $("#loading-icon2").hide();
              } 
            }
        }
    
        function handleData1(data) {
          if (data.hasOwnProperty('interState')) {
            if (data.interState == 'intermediate' || data.interState == 'finished') {
              processData1(data);
            }
          } else {
            processData1(data);
          }
        }
    
        function processData(data) {


          if (data.hasOwnProperty('session_id')) {
                session_id = data.session_id;
                if (data.hasOwnProperty('sections')) {
                    if (data.sections.hasOwnProperty('GENERATE_RESPONSE')) {
                        $("#previous-response").val(data.sections.GENERATE_RESPONSE);
                    }
                    if (data.sections.hasOwnProperty('GIVE_LESSON')) {
                        states.lessson = data.sections.GIVE_LESSON;
                    }
                    if (data.sections.hasOwnProperty('GENERATE_UPDATED_PROMPT')) {
                        states.lastPrompt = data.sections.GENERATE_UPDATED_PROMPT;
                    }
                    if (data.sections.hasOwnProperty('GIVE_NEW_RESPONSE')) {
                        states.lastResponse = data.sections.GIVE_NEW_RESPONSE;
                    }
                    if (data.sections.hasOwnProperty('SUGGEST_REFERENCE')){
	                states.lastReference = data.sections.SUGGEST_REFERENCE;
			$("#refer1").val(data.sections.SUGGEST_REFERENCE);
                    }     

                    if (data.sections.hasOwnProperty('SUGGEST_INITIAL_REFERENCES')){
	                states.lastInitialReferences = data.sections.SUGGEST_INITIAL_REFERENCES;
			$("#refer").val(data.sections.SUGGEST_INITIAL_REFERENCES);
                    }     
                }
            }
            addItem2()
        }
        function processData1(data) {


          if (data.hasOwnProperty('session_id')) {
                session_id = data.session_id;
                if (data.hasOwnProperty('sections')) {
                    if (data.sections.hasOwnProperty('GENERATE_RESPONSE')) {
                        $("#previous-response").val(data.sections.GENERATE_RESPONSE);
                    }
                    if (data.sections.hasOwnProperty('GIVE_LESSON')) {
                        states.lessson = data.sections.GIVE_LESSON;
                    }
                    if (data.sections.hasOwnProperty('GENERATE_UPDATED_PROMPT')) {
                        states.lastPrompt = data.sections.GENERATE_UPDATED_PROMPT;
                    }
                    if (data.sections.hasOwnProperty('GIVE_NEW_RESPONSE')) {
                        states.lastResponse = data.sections.GIVE_NEW_RESPONSE;
                    }
                    if (data.sections.hasOwnProperty('SUGGEST_REFERENCE')) {
	                states.lastReference = data.sections.SUGGEST_REFERENCE;
			$("#refer").val(data.sections.SUGGEST_REFERENCE);
                    }
                    if (data.sections.hasOwnProperty('SUGGEST_INITIAL_REFERENCES')) {
	                states.lastReference = data.sections.SUGGEST_INITIAL_REFERENCES;
			$("#refer").val(data.sections.SUGGEST_INITIAL_REFERENCES);
                    }
                }
            }
          
        }

        
        var streamEnabled = false;
        var states = {
            isFirstInteraction: true,
            previousPrompt: "",
            previousResponse: "",
            lastPrompt: "",
            lastResponse: "",
            lastReference: "",
            lesson: ""
        };
        
        $("#submit-button").click(function() {
            var input = $("#input-field").val();
            if (states.isFirstInteraction) {
                states.previousPrompt = input;
                states.isFirstInteraction = false;
                $("#submit-button").text("Submit Feedback");  // Change button text after first interaction
                submitForm1(input, streamEnabled);
                
            } else {
                var input = $("#input-field1").val();
                submitForm1(input, streamEnabled);
            }
        
            // Clear the input field after every submission
            $("#input-field").val("");
        
            // Update UI based on states
            $("#previous-prompt").val(states.previousPrompt);
          $("#input-field").hide();
          $("#submit-button").hide();

        });

        $("#submit-button2").click(function() {
            var input = $("#input-field1").val();
            submitForm(input, streamEnabled);
        
            // Clear the input field after every submission
             $("#input-field1").val("");
        
            // Update UI based on states
            $("#previous-prompt").val(states.previousPrompt);

        });
        function reload(){
          const button = document.querySelector("#newQ");
          button.addEventListener("click", () =>{
            window.location.reload(true);
          })
        }

</script>
   
  </body>
</html>




